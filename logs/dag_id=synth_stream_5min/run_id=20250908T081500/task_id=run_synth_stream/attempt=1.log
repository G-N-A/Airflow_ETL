[2025-09-08T13:52:47.853+0530] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-09-08T13:52:48.279+0530] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: synth_stream_5min.run_synth_stream scheduled__2025-09-08T08:15:00+00:00 [queued]>
[2025-09-08T13:52:48.283+0530] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: synth_stream_5min.run_synth_stream scheduled__2025-09-08T08:15:00+00:00 [queued]>
[2025-09-08T13:52:48.283+0530] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2025-09-08T13:52:48.496+0530] {taskinstance.py:2330} INFO - Executing <Task(BashOperator): run_synth_stream> on 2025-09-08 08:15:00+00:00
[2025-09-08T13:52:48.504+0530] {standard_task_runner.py:64} INFO - Started process 723021 to run task
[2025-09-08T13:52:48.510+0530] {standard_task_runner.py:90} INFO - Running: ['airflow', 'tasks', 'run', 'synth_stream_5min', 'run_synth_stream', 'scheduled__2025-09-08T08:15:00+00:00', '--job-id', '35', '--raw', '--subdir', 'DAGS_FOLDER/ecom_schedules.py', '--cfg-path', '/tmp/tmpmnd_42o2']
[2025-09-08T13:52:48.511+0530] {standard_task_runner.py:91} INFO - Job 35: Subtask run_synth_stream
[2025-09-08T13:52:48.696+0530] {task_command.py:426} INFO - Running <TaskInstance: synth_stream_5min.run_synth_stream scheduled__2025-09-08T08:15:00+00:00 [running]> on host softsuave-ASUS-EXPERTCENTER-D700ME-D500ME
[2025-09-08T13:52:49.398+0530] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='synth_stream_5min' AIRFLOW_CTX_TASK_ID='run_synth_stream' AIRFLOW_CTX_EXECUTION_DATE='2025-09-08T08:15:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-09-08T08:15:00+00:00'
[2025-09-08T13:52:49.399+0530] {taskinstance.py:430} INFO - ::endgroup::
[2025-09-08T13:52:49.471+0530] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-09-08T13:52:49.472+0530] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'bash /media/softsuave/DATA-HDD/DataEngineering/Apache_Airflow/scripts/synth/run_synth_stream.sh | cat']
[2025-09-08T13:52:49.485+0530] {subprocess.py:86} INFO - Output:
[2025-09-08T13:52:49.583+0530] {subprocess.py:93} INFO - [2025-09-08 13:52:49] üöÄ Starting Synthetic E-commerce Data Stream...
[2025-09-08T13:52:49.583+0530] {subprocess.py:93} INFO - ----------------------------------------------
[2025-09-08T13:52:49.584+0530] {subprocess.py:93} INFO -  Database   : ecom_db
[2025-09-08T13:52:49.584+0530] {subprocess.py:93} INFO -  User       : sa
[2025-09-08T13:52:49.584+0530] {subprocess.py:93} INFO -  Server     : localhost:1433
[2025-09-08T13:52:49.584+0530] {subprocess.py:93} INFO -  Interval   : 5 min
[2025-09-08T13:52:49.584+0530] {subprocess.py:93} INFO -  Orders     : 50
[2025-09-08T13:52:49.584+0530] {subprocess.py:93} INFO -  Clicks     : 100
[2025-09-08T13:52:49.584+0530] {subprocess.py:93} INFO -  Webhook    : http://localhost:5000/webhook
[2025-09-08T13:52:49.584+0530] {subprocess.py:93} INFO - ----------------------------------------------
[2025-09-08T13:52:49.584+0530] {subprocess.py:93} INFO - 
[2025-09-08T13:52:49.760+0530] {subprocess.py:93} INFO - [2025-09-08 13:52:49] üîß Activating virtual environment...
[2025-09-08T13:52:49.840+0530] {subprocess.py:93} INFO - [2025-09-08 13:52:49] üîç Checking database connection...
[2025-09-08T13:52:50.334+0530] {subprocess.py:93} INFO - ‚úÖ Database connection successful
[2025-09-08T13:52:50.338+0530] {subprocess.py:93} INFO - [2025-09-08 13:52:50] üîÑ Starting synthetic data stream...
[2025-09-08T13:52:50.338+0530] {subprocess.py:93} INFO - Press Ctrl+C to stop
[2025-09-08T13:52:50.338+0530] {subprocess.py:93} INFO - 
[2025-09-08T13:52:51.978+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:51,978 INFO: Tables ensured/created (if needed).
[2025-09-08T13:52:52.216+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:52,215 INFO: Customers: 1000 already present; skipping seeding.
[2025-09-08T13:52:52.220+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:52,220 INFO: Products: 500 already present; skipping seeding.
[2025-09-08T13:52:52.221+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:52,221 INFO: Running one-shot generation: orders=5000, sessions=3000
[2025-09-08T13:52:52.241+0530] {subprocess.py:93} INFO - /media/softsuave/DATA-HDD/DataEngineering/Apache_Airflow/src/synth_ecom_mssql_stream.py:397: RemovedIn20Warning: Deprecated API features detected! These feature(s) are not compatible with SQLAlchemy 2.0. To prevent incompatible upgrades prior to updating applications, ensure requirements files are pinned to "sqlalchemy<2.0". Set environment variable SQLALCHEMY_WARN_20=1 to show all deprecation warnings.  Set environment variable SQLALCHEMY_SILENCE_UBER_WARNING=1 to silence this message. (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
[2025-09-08T13:52:52.241+0530] {subprocess.py:93} INFO -   customers = [dict(r) for r in conn.execute(select(self.tables["customers"])).fetchall()]
[2025-09-08T13:52:52.249+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:52,249 INFO: Generating 5000 orders (batch_size=200, force_order_date_now=False)...
[2025-09-08T13:52:52.913+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:52,912 INFO: Flushed batch: orders=200 items=358
[2025-09-08T13:52:52.917+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:52,917 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786d8e440>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:53.164+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:53,163 INFO: Flushed batch: orders=200 items=341
[2025-09-08T13:52:53.166+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:53,166 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786dd02b0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:53.705+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:53,705 INFO: Flushed batch: orders=200 items=330
[2025-09-08T13:52:53.706+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:53,706 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786eade70>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:53.923+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:53,923 INFO: Flushed batch: orders=200 items=339
[2025-09-08T13:52:53.926+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:53,926 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786dd2e90>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:54.190+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:54,189 INFO: Flushed batch: orders=200 items=352
[2025-09-08T13:52:54.193+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:54,193 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786dd1540>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:54.608+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:54,608 INFO: Flushed batch: orders=200 items=338
[2025-09-08T13:52:54.611+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:54,610 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786c110f0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:54.825+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:54,824 INFO: Flushed batch: orders=200 items=349
[2025-09-08T13:52:54.827+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:54,827 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786d8e710>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:55.025+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:55,024 INFO: Flushed batch: orders=200 items=345
[2025-09-08T13:52:55.027+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:55,027 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786c13100>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:55.509+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:55,509 INFO: Flushed batch: orders=200 items=344
[2025-09-08T13:52:55.512+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:55,511 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786e30820>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:55.717+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:55,717 INFO: Flushed batch: orders=200 items=336
[2025-09-08T13:52:55.720+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:55,720 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786c28430>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:55.928+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:55,928 INFO: Flushed batch: orders=200 items=342
[2025-09-08T13:52:55.930+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:55,930 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786c10df0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:56.345+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:56,345 INFO: Flushed batch: orders=200 items=356
[2025-09-08T13:52:56.348+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:56,348 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786f54310>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:56.520+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:56,520 INFO: Flushed batch: orders=200 items=331
[2025-09-08T13:52:56.523+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:56,523 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786c12950>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:56.721+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:56,721 INFO: Flushed batch: orders=200 items=357
[2025-09-08T13:52:56.724+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:56,723 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786e30070>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:57.013+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:57,013 INFO: Flushed batch: orders=200 items=345
[2025-09-08T13:52:57.016+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:57,016 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786c42650>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:57.214+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:57,213 INFO: Flushed batch: orders=200 items=365
[2025-09-08T13:52:57.216+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:57,216 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786c2a1d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:57.423+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:57,423 INFO: Flushed batch: orders=200 items=329
[2025-09-08T13:52:57.426+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:57,425 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786c41fc0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:57.860+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:57,860 INFO: Flushed batch: orders=200 items=355
[2025-09-08T13:52:57.863+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:57,863 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786c29e40>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:58.111+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:58,111 INFO: Flushed batch: orders=200 items=337
[2025-09-08T13:52:58.112+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:58,112 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786c63d60>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:58.300+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:58,299 INFO: Flushed batch: orders=200 items=321
[2025-09-08T13:52:58.303+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:58,303 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786dfd9f0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:58.500+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:58,500 INFO: Flushed batch: orders=200 items=383
[2025-09-08T13:52:58.503+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:58,503 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786c61420>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:58.869+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:58,869 INFO: Flushed batch: orders=200 items=316
[2025-09-08T13:52:58.872+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:58,872 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786c297b0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:59.171+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:59,171 INFO: Flushed batch: orders=200 items=343
[2025-09-08T13:52:59.175+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:59,175 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786c7baf0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:59.419+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:59,419 INFO: Flushed batch: orders=200 items=346
[2025-09-08T13:52:59.422+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:59,422 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786c628f0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:59.787+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:59,787 INFO: Flushed batch: orders=200 items=365
[2025-09-08T13:52:59.790+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:59,789 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786c63cd0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:52:59.790+0530] {subprocess.py:93} INFO - 2025-09-08 13:52:59,790 INFO: Generated 5000 orders
[2025-09-08T13:53:33.022+0530] {subprocess.py:93} INFO - 2025-09-08 13:53:33,021 INFO: Inserted 47804 clickstream events.
[2025-09-08T13:53:33.023+0530] {subprocess.py:93} INFO - 2025-09-08 13:53:33,022 WARNING: Failed to send webhook notification: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /webhook (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x791786f18640>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-09-08T13:53:34.041+0530] {subprocess.py:93} INFO - 2025-09-08 13:53:34,041 INFO: Validation done: orphans orders=0 items=0 inventory=0 mismatches=0
[2025-09-08T13:53:34.048+0530] {subprocess.py:93} INFO - 2025-09-08 13:53:34,047 INFO: Integrity report: {'orphan_orders': 0, 'orphan_order_items': 0, 'inventory_orphans': 0, 'order_amount_mismatches': []}
[2025-09-08T13:53:34.078+0530] {subprocess.py:93} INFO - [2025-09-08 13:53:34] ‚úÖ Synthetic data streaming completed successfully!
[2025-09-08T13:53:34.078+0530] {subprocess.py:97} INFO - Command exited with return code 0
[2025-09-08T13:53:34.078+0530] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-09-08T13:53:34.301+0530] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=synth_stream_5min, task_id=run_synth_stream, run_id=scheduled__2025-09-08T08:15:00+00:00, execution_date=20250908T081500, start_date=20250908T082248, end_date=20250908T082334
[2025-09-08T13:53:34.547+0530] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2025-09-08T13:53:34.552+0530] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-09-08T13:53:34.552+0530] {local_task_job_runner.py:222} INFO - ::endgroup::
